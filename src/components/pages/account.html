<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Account</title>
    <link rel="Icon" href="/Data/Icon/Account/Account_3.png" />
    <link
      rel="stylesheet"
      href="../../../bootstrap-5.0.2-dist/css/bootstrap.min.css"
    />
    <script src="../../../jquery-3.7.1/jquery-3.7.1.min.js"></script>
    <script src="../../../bootstrap-5.0.2-dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="../../css/styles.css" />
  </head>
  <body>
    <!-- <header id="header"></header> -->
    <main class="d-flex">
      <!-- Sidebar -->
      <div
        id="sidebar"
        class="bg-light border-right"
        style="width: 250px; height: 100vh"
      >
        <h5 class="p-3">Quản lý tài khoản</h5>
        <ul class="nav flex-column">
          <li class="nav-item">
            <a href="#profileSection" class="nav-link active" id="profileLink"
              >Hồ sơ</a
            >
          </li>
          <li class="nav-item">
            <a href="#addressSection" class="nav-link" id="addressLink"
              >Địa chỉ</a
            >
          </li>
          <li class="nav-item">
            <a
              href="#changePasswordSection"
              class="nav-link"
              id="changePasswordLink"
              >Đổi mật khẩu</a
            >
          </li>
        </ul>
      </div>

      <!-- Main Content -->
      <div id="mainContent" class="flex-fill p-4">
        <!-- Hồ sơ -->
        <section id="profileSection" class="content-section active">
          <h2>Thông tin tài khoản</h2>
          <form id="accountForm" autocomplete="on">
            <div class="mb-3">
              <label for="userName" class="form-label">Tên đăng nhập</label>
              <input
                type="text"
                class="form-control"
                id="userName"
                size="20"
                maxlength="20"
              />
            </div>
            <div class="mb-3">
              <label for="fullName" class="form-label">Họ và tên</label>
              <input
                type="text"
                class="form-control"
                id="fullName"
                value="Nguyễn Văn A"
              />
            </div>

            <div class="mb-3">
              <label for="birthDate" class="form-label">Ngày sinh</label>
              <div class="d-flex">
                <!-- Dropdown cho Ngày -->
                <select
                  id="birthDay"
                  class="form-select me-2"
                  aria-label="Chọn ngày"
                >
                  <option selected disabled>Ngày</option>
                </select>

                <!-- Dropdown cho Tháng -->
                <select
                  id="birthMonth"
                  class="form-select me-2"
                  aria-label="Chọn tháng"
                >
                  <option selected disabled>Tháng</option>
                </select>

                <!-- Dropdown cho Năm -->
                <select
                  id="birthYear"
                  class="form-select"
                  aria-label="Chọn năm"
                >
                  <option selected disabled>Năm</option>
                </select>
              </div>
            </div>

            <div class="mb-3">
              <label for="email" class="form-label">Email</label>
              <input
                type="email"
                class="form-control"
                id="email"
                placeholder="Nhập địa chỉ email"
                pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                title="Vui lòng nhập đúng định dạng email (ví dụ: example@gmail.com)"
              />
            </div>

            <div class="mb-3">
              <label for="phone" class="form-label">Số điện thoại</label>
              <input
                type="text"
                class="form-control"
                id="phone"
                placeholder="Nhập số điện thoại"
                inputmode="numeric"
                pattern="^0 [3-9]\d{8}$"
                maxlength="10"
              />
            </div>

            <div id="phoneError" class="invalid-feedback">
              Số điện thoại phải bắt đầu bằng (03-09) và có 10 chữ số theo định
              dạng Việt Nam.
            </div>

            <button type="button" class="btn btn-primary">
              Cập nhật thông tin
            </button>
          </form>
        </section>

        <!-- Địa chỉ -->
        <section id="addressSection" class="content-section d-none">
          <h2>Địa chỉ liên lạc</h2>
          <form id="addressForm" autocomplete="on">
            <div class="mb-3">
              <label for="streetAddress" class="form-label"
                >Địa chỉ đường</label
              >
              <input
                type="text"
                class="form-control"
                id="streetAddress"
                placeholder="Nhập địa chỉ đường"
              />
            </div>
            <div class="mb-3">
              <label for="city" class="form-label">Thành phố</label>
              <input
                type="text"
                class="form-control"
                id="city"
                placeholder="Nhập thành phố"
              />
            </div>
            <div class="mb-3">
              <label for="postalCode" class="form-label">Mã bưu điện</label>
              <input
                type="text"
                class="form-control"
                id="postalCode"
                placeholder="Nhập mã bưu điện"
              />
            </div>
            <button type="button" class="btn btn-primary">
              Cập nhật địa chỉ
            </button>
          </form>
        </section>

        <!-- Đổi mật khẩu -->
        <section id="changePasswordSection" class="content-section d-none">
          <h2>Đổi mật khẩu</h2>
          <form id="changePasswordForm">
            <div class="mb-3">
              <label for="password" class="form-label">Mật khẩu hiện tại</label>
              <input
                type="password"
                class="form-control"
                id="password"
                placeholder="Nhập mật khẩu hiện tại"
              />
            </div>
            <div class="mb-3">
              <label for="newPassword" class="form-label">Mật khẩu mới</label>
              <input
                type="password"
                class="form-control"
                id="newPassword"
                placeholder="Nhập mật khẩu mới"
              />
            </div>
            <div class="mb-3">
              <label for="confirmPassword" class="form-label"
                >Xác nhận mật khẩu mới</label
              >
              <input
                type="password"
                class="form-control"
                id="confirmPassword"
                placeholder="Xác nhận mật khẩu mới"
              />
            </div>
            <button type="submit" class="btn btn-primary">
              Cập nhật mật khẩu
            </button>
          </form>

          <!-- Thông báo lỗi hoặc thành công -->
          <div id="message" class="mt-3"></div>
        </section>
      </div>
    </main>

    <footer id="footer"></footer>

    <script src="../../components/common/header.js"></script>
    <script src="../../components/common/footer.js"></script>
    <script src="../../js/components/main.js"></script>

    <script>
      // Xử lý sidebar
      $("#sidebar .nav-link").on("click", function () {
        $("#sidebar .nav-link").removeClass("active");
        $(this).addClass("active");
        $(".content-section").removeClass("active").addClass("d-none");
        const targetId = $(this).attr("href");
        $(targetId).removeClass("d-none").addClass("active");
      });

      // Xử lý khi submit form đổi mật khẩu
      $("#changePasswordForm").on("submit", function (e) {
        e.preventDefault();
        let currentPassword = $("#password").val();
        let newPassword = $("#newPassword").val();
        let confirmPassword = $("#confirmPassword").val();

        // Kiểm tra mật khẩu cũ và mật khẩu mới
        if (newPassword === currentPassword) {
          $("#message").html(
            '<div class="alert alert-danger">Mật khẩu mới không thể trùng với mật khẩu cũ!</div>'
          );
          return;
        }

        // Kiểm tra nếu các trường mật khẩu trống
        if (!currentPassword || !newPassword || !confirmPassword) {
          $("#message").html(
            '<div class="alert alert-danger">Tất cả các trường mật khẩu đều là bắt buộc!</div>'
          );
          return;
        }

        // Kiểm tra mật khẩu mới và xác nhận mật khẩu
        if (newPassword !== confirmPassword) {
          $("#message").html(
            '<div class="alert alert-danger">Mật khẩu mới và xác nhận không khớp!</div>'
          );
        } else {
          // Gửi thông tin cập nhật lên server hoặc xử lý ở đây
          $("#message").html(
            '<div class="alert alert-success">Cập nhật thông tin thành công!</div>'
          );
        }
      });
    </script>

    <script>
      //Xử lý cho các ô drop down ngày, tháng, năm
      $(document).ready(function () {
        // Tạo các lựa chọn cho dropdown Ngày
        for (let day = 1; day <= 31; day++) {
          $("#birthDay").append(`<option value="${day}">${day}</option>`);
        }

        // Tạo các lựa chọn cho dropdown Tháng
        for (let month = 1; month <= 12; month++) {
          $("#birthMonth").append(`<option value="${month}">${month}</option>`);
        }

        // Tạo các lựa chọn cho dropdown Năm
        const currentYear = new Date().getFullYear();
        for (let year = currentYear; year >= 1900; year--) {
          $("#birthYear").append(`<option value="${year}">${year}</option>`);
        }
      });
    </script>

    <script>
      // Xử lý ô số điện thoại
      // Chặn ký tự không phải số
      $("#phone").on("input", function () {
        this.value = this.value.replace(/[^0-9]/g, "");
      });

      // Kiểm tra và hiển thị lỗi cho ô nhập số điện thoại
      $("#phone").on("input", function () {
        const phonePattern = /^0[3-9]\d{8}$/;
        const phoneNumber = this.value;

        if (phonePattern.test(phoneNumber)) {
          // Nếu đúng định dạng, bỏ lỗi
          $(this).removeClass("is-invalid");
          $(this).addClass("is-valid");
          $("#phoneError").hide();
        } else {
          // Nếu sai định dạng, hiển thị lỗi
          $(this).removeClass("is-valid");
          $(this).addClass("is-invalid");
          $("#phoneError").show();
        }
      });
    </script>

    <script>
      //Xử lý ô nhập email
      $("#email").on("input", function () {
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        const emailInput = $(this).val();

        if (!emailPattern.test(emailInput)) {
          $(this).addClass("is-invalid");
        } else {
          $(this).removeClass("is-invalid");
        }
      });
    </script>
  </body>
</html>
